From 536c58c55641f2b93c95aa38d2893385f412786d Mon Sep 17 00:00:00 2001
From: Marius Kittler <mariuskittler@gmx.de>
Date: Sun, 3 Feb 2019 17:40:35 +0100
Subject: [PATCH 6/6] Make windeployqt cross-platform (again)

Change-Id: I58d3d37fcc4d9da5879000e999707b007c4a7b39
Reviewed-by: Friedemann Kleint <Friedemann.Kleint@qt.io>
---
 src/windeployqt/main.cpp | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/src/windeployqt/main.cpp b/src/windeployqt/main.cpp
index da61f9b8..d0070747 100644
--- a/src/windeployqt/main.cpp
+++ b/src/windeployqt/main.cpp
@@ -40,7 +40,12 @@
 #include <QtCore/QOperatingSystemVersion>
 #include <QtCore/QSharedPointer>
 #include <QtCore/QVector>
+
+#ifdef Q_OS_WIN
 #include <QtCore/qt_windows.h>
+#else
+#define IMAGE_FILE_MACHINE_ARM64 0xaa64
+#endif
 
 #include <algorithm>
 #include <iostream>
@@ -1102,6 +1107,7 @@ static QStringList compilerRunTimeLibs(Platform platform, bool isDebug, unsigned
                 result.append(dllFi.absoluteFilePath());
     }
         break;
+#ifdef Q_OS_WIN
     case WindowsDesktop: { // MSVC/Desktop: Add redistributable packages.
         QString vcRedistDirName = vcRedistDir();
         if (vcRedistDirName.isEmpty())
@@ -1141,6 +1147,7 @@ static QStringList compilerRunTimeLibs(Platform platform, bool isDebug, unsigned
         result.append(redistFiles);
     }
         break;
+#endif // Q_OS_WIN
     default:
         break;
     }
-- 
2.17.1

